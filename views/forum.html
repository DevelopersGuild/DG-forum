{% extends "base.html" %}

{% block page %}

<div>
    <h2>Create New Thread</h2>
    <form action = "makethread" method = "post" name = "makethread">
      <textarea name="subject" rows="1" cols="52" placeholder = "title"></textarea><br> 
      <textarea name="message" rows="10" cols="52" placeholder = "message"></textarea><br>
      <button type = "submit">Submit</button>
    </form>
</div>

<div>
  <h2>Threads</h2>
  <!-- Loop through threads array-->
  {% for thread in threads %}
    <hr>
    <!-- Thread title and author -->
    <h3>{{ thread.subject }} by {{ thread.author }}</h3> 

    <!-- Thread time -->
    <h6>{{ convertToDate(thread.timestamp) }}</h6>


    <!-- Thread content -->
    <p>{{ thread.message }}</p>

    <!-- Test to see if the array has any elements -->
    {% if thread.replies[0] %}
    <div>
    <h4>Replies</h4>
      -----------------------------------
    <!-- Loop through replies array-->
    {% for reply in thread.replies %}
      <div>
        <!-- Reply Author -->
        <h5>{{ reply.author }}</h5>

        <!-- Reply time -->
        <h6>{{ convertToDate(reply.timestamp) }}</h6>

        <!-- Reply content -->
        <p>{{ reply.message }}</p>
      </div>

    {% endfor %}


    </div>
    {% endif %}

    <div>
      <h3>Reply to Thread</h3>
        <form action = "thread/{{ thread._id }}/reply" method = "post" name = "makereply">
          <input type = "text" placeholder = "message" name = "message">
          <button type = "submit">Submit</button>
        </form>
    </div>
  {% endfor %}
</div>

{% endblock %}
