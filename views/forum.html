{% extends "base.html" %}

{% block page %}

{% include "partials/projects.html" %}

    <!-- GENERAL DISCUSSION -->
    <div class="discussion-container">

      <div class="thread-menubar">
        <span id="discussion-title">General Discussion</span>
        <span id="pages">
          {% if page != 1 %}
            <a href="../?page={{ page - 1 }}">Prev</a>
            <a href="../?page={{ page - 1 }}">{{ page - 1 }}</a>
          {% endif %}

          <span>{{ page }}</span>

          {% if page != lastPage %}
          <a href="../?page={{ page + 1 }}">{{ page + 1 }}</a>
          <a href="../?page={{ page + 1 }}">Next</a>
          {% endif %}

        </span>
        {% if sessUser %}
        <span class="post-thread">
          <a href="#post" data-toggle="modal">Post New Thread</a>
        </span>
        {% endif %}
      </div>

      <div>
        {% for thread in threads %}
        <ul class="threadlist">
          {% if loop.index % 2 == 0 %}
          <li class="thread-no-border">
          {% else %}
          <li class="thread-border">
          {% endif %}
            <div class="avatar-small" title="{{ thread.author }}" style="background-image: url(../avatars/{{ thread.authorUser.profile.avatar }}); background-size: 75%;"></div>

            <div class="contain-title">
              <div class="ellipsed">
                <a href="thread/{{ thread.prettyId }}" style="font-size:1.2em;">{{ thread.subject }}</a>
                <span style="font-size:1em;">({{ thread.views }} views)</span>
              </div>
              <div class="ellipsed">
                <div class="ellipsed2">submitted by <a href="#" class="author">{{ thread.author }}</a> {{ convertToDate(thread.creationDate) }}</div>
              </div>
            </div>

            <!-- TODO: templating for last reply, author and date-->

            <div class="contain-title2">
              <div class="ellipsed2"><a>Last post</a> by <a href="#" class="last-poster">last poster</a></div>
              <div class="ellipsed2">n seconds ago</div>
            </div>
          </li>
        </ul>
        {% endfor %}
      </div>

    </div>
    <!-- END GENERAL DISCUSSION -->

    <!-- FEED -
    <div class="feed-title"><span>Feed</span></div>
    <div class="feed-container">
      <ul class="feed">
        <li class="feed-item-grey">
          <div><a href="#">you reach i teach</a></div>
          <span>submitted by <a href="#" class="author">kobe</a> 1 second ago</span>
        </li>
        <li class="feed-item-white">
          <div><a href="#">you reach i teach</a></div>
          <span class="feed-bottom"> submitted by <a href="#" class="author">kobe</a> 1 second ago in <a href="thread.html">Sample thread</a>
          </span>
        </li>
        <li class="feed-item-grey">
          <div><a href="#">you reach i teach</a></div>
          <span>submitted by <a href="#" class="author">kobe</a>  1 second ago</span>
        </li>
        <li class="feed-item-white">
          <div><a href="#">you reach i teach</a></div>
          <span>submitted by <a href="#" class="author">kobe</a> 1 second ago</span>
        </li>
      </ul>
    </div>
    <!-- END FEED -->

    <!-- ONLINE -->
    <div class="online-title"><span>Online users</span></div>
    <div class="online">

    	{% for user in onlineUsers %}
  
      	<span class="avatar-small" title="{{ user.username }}" style="background-image: url(../avatars/{{ user.profile.avatar }}); background-size: 75%;"></span>
      	
    	{% endfor %}

    </div>
    <!-- END ONLINE -->

    <!-- POST THREAD MODAL -->
    <div class="modal fade" id="post" role="dialog">
      <div class ="modal-dialog">
        <div class ="modal-content">
          <div class ="modal-header">
            <span>Post New Thread</span>
            <a href="#" style="float:right;" data-dismiss="modal">X</a>
          </div>
          <div class="modal-body">
            <form id="createThread_form"action="makethread" method="post" name="makethread">
              <img src="../img/loading.gif" id="loadingIcon_createThread" height="32px" width="32px" style="display:none">
              <textarea name="subject" id="titlebox" rows="1" dir="ltr" maxlength="50" required placeholder="Title"></textarea>
              <textarea name="message" id="replybox" name="reply" rows="10" dir="ltr" required placeholder="Message"></textarea>
              <div>
                  <input class="btn" class="button" value="POST" type="submit"/>
                  <label id="error_createThread" style="display:none"></label>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- END POST THREAD MODAL -->

{% endblock %}
